<Page x:Class="kanzeed.Pages.UserProfilePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:data="clr-namespace:kanzeed.ApplicationData"
      Title="Личный кабинет"
      Background="#F8F9FA">

    <Page.Resources>
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#4361EE"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="15,0"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#4361EE"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="15,0"/>
            <Setter Property="BorderBrush" Value="#4361EE"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Page.Resources>

    <Grid>
        <Border Background="White" CornerRadius="12" Margin="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- HEADER -->
                <Border Background="#F8F9FA" Padding="20" CornerRadius="12,12,0,0">
                    <StackPanel>
                        <TextBlock Text="ЛИЧНЫЙ КАБИНЕТ" FontSize="20" FontWeight="Bold"/>
                        <TextBlock Text="Профиль пользователя" FontSize="12" Foreground="#666"/>
                    </StackPanel>
                </Border>

                <!-- CONTENT -->
                <Grid Grid.Row="1" Margin="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>

                    <!-- PROFILE -->
                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                        <TextBlock Text="Личные данные" FontWeight="Bold"/>

                        <TextBlock Text="Фамилия"/>
                        <TextBox x:Name="LastNameBox"/>

                        <TextBlock Text="Имя"/>
                        <TextBox x:Name="FirstNameBox"/>

                        <TextBlock Text="Отчество"/>
                        <TextBox x:Name="MiddleNameBox"/>

                        <TextBlock Text="Email"/>
                        <TextBox x:Name="EmailBox"/>

                        <TextBlock Text="Телефон"/>
                        <TextBox x:Name="PhoneBox"
                                 TextChanged="PhoneBox_TextChanged"
                                 PreviewTextInput="PhoneBox_PreviewTextInput"/>

                        <TextBlock Text="Смена пароля"
           FontWeight="Bold"
           Margin="0,15,0,5"/>

                        <TextBlock Text="Текущий пароль"/>
                        <PasswordBox x:Name="CurrentPasswordBox"/>

                        <TextBlock Text="Новый пароль"/>
                        <PasswordBox x:Name="NewPasswordBox"/>

                        <TextBlock Text="Повторите новый пароль"/>
                        <PasswordBox x:Name="ConfirmPasswordBox"/>


                        <Button Content="Сохранить изменения"
                                Style="{StaticResource PrimaryButtonStyle}"
                                Margin="0,10,0,0"
                                Click="SaveProfile_Click"/>

                        <Button Content="← Вернуться к товарам"
                                Style="{StaticResource SecondaryButtonStyle}"
                                Margin="0,10,0,0"
                                Click="BackToCatalog_Click"/>
                    </StackPanel>

                    <!-- TABS -->
                    <TabControl Grid.Column="1">
                        <!-- ORDERS -->
                        <TabItem Header="Заказы">
                            <ListView x:Name="OrdersList">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="№" DisplayMemberBinding="{Binding order_id}" Width="60"/>
                                        <GridViewColumn Header="Дата" DisplayMemberBinding="{Binding order_date}" Width="140"/>
                                        <GridViewColumn Header="Сумма" DisplayMemberBinding="{Binding total_amount}" Width="100"/>
                                        <GridViewColumn Header="Статус" DisplayMemberBinding="{Binding ORDER_STATUSES.status_name}" Width="140"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </TabItem>

                        <!-- ADDRESSES -->
                        <TabItem Header="Адреса">
                            <StackPanel>

                                <!-- СПИСОК АДРЕСОВ -->
                                <ListView x:Name="AddressesList" Height="200" Margin="0,0,0,10">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <DockPanel Margin="0,4">
                                                <TextBlock Text="{Binding city}" Width="90"/>
                                                <TextBlock Text="{Binding street}" Width="140" Margin="10,0,0,0"/>
                                                <Button Content="✖"
                                DockPanel.Dock="Right"
                                Tag="{Binding address_id}"
                                Click="DeleteAddress_Click"/>
                                            </DockPanel>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>

                                <!-- ДОБАВЛЕНИЕ АДРЕСА -->
                                <TextBlock Text="Добавить адрес"
                   FontWeight="SemiBold"
                   Margin="0,10,0,8"/>

                                <TextBlock Text="Город"/>
                                <TextBox x:Name="CityBox"/>

                                <TextBlock Text="Почтовый индекс"/>
                                <TextBox x:Name="PostalCodeBox"/>

                                <TextBlock Text="Улица"/>
                                <TextBox x:Name="StreetBox"/>

                                <TextBlock Text="Дом"/>
                                <TextBox x:Name="HouseBox"/>

                                <TextBlock Text="Этаж (необязательно)"/>
                                <TextBox x:Name="FloorBox"/>

                                <TextBlock Text="Квартира (необязательно)"/>
                                <TextBox x:Name="ApartmentBox"/>

                                <TextBlock Text="Подъезд (необязательно)"/>
                                <TextBox x:Name="PorchBox"/>

                                <Button Content="Добавить адрес"
                Style="{StaticResource PrimaryButtonStyle}"
                Margin="0,10,0,0"
                Click="AddAddress_Click"/>
                            </StackPanel>
                        </TabItem>

                    </TabControl>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Page>
